<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>controllers/productos-controllers.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="CategoriasController.html">CategoriasController</a><ul class='methods'><li data-type='method'><a href="CategoriasController.html#.activarCategoria">activarCategoria</a></li><li data-type='method'><a href="CategoriasController.html#.buscarCategoria">buscarCategoria</a></li><li data-type='method'><a href="CategoriasController.html#.crearCategoria">crearCategoria</a></li><li data-type='method'><a href="CategoriasController.html#.editarCategoria">editarCategoria</a></li><li data-type='method'><a href="CategoriasController.html#.listarCategorias">listarCategorias</a></li><li data-type='method'><a href="CategoriasController.html#.obtenerTotalCategorias">obtenerTotalCategorias</a></li></ul></li><li><a href="CategoryTableComponent.html">CategoryTableComponent</a><ul class='methods'><li data-type='method'><a href="CategoryTableComponent.html#activeCategory">activeCategory</a></li><li data-type='method'><a href="CategoryTableComponent.html#createCategory">createCategory</a></li><li data-type='method'><a href="CategoryTableComponent.html#editCategory">editCategory</a></li><li data-type='method'><a href="CategoryTableComponent.html#getAll">getAll</a></li><li data-type='method'><a href="CategoryTableComponent.html#getName">getName</a></li><li data-type='method'><a href="CategoryTableComponent.html#openModalConfirm">openModalConfirm</a></li><li data-type='method'><a href="CategoryTableComponent.html#render">render</a></li><li data-type='method'><a href="CategoryTableComponent.html#searchCategories">searchCategories</a></li><li data-type='method'><a href="CategoryTableComponent.html#selectCategory">selectCategory</a></li><li data-type='method'><a href="CategoryTableComponent.html#setRows">setRows</a></li></ul></li><li><a href="ClientesController.html">ClientesController</a><ul class='methods'><li data-type='method'><a href="ClientesController.html#.buscarCliente">buscarCliente</a></li><li data-type='method'><a href="ClientesController.html#.crearCliente">crearCliente</a></li><li data-type='method'><a href="ClientesController.html#.editarCliente">editarCliente</a></li><li data-type='method'><a href="ClientesController.html#.listarClientes">listarClientes</a></li><li data-type='method'><a href="ClientesController.html#.obtenerTotalClientes">obtenerTotalClientes</a></li></ul></li><li><a href="ClientsTableComponent.html">ClientsTableComponent</a><ul class='methods'><li data-type='method'><a href="ClientsTableComponent.html#addClient">addClient</a></li><li data-type='method'><a href="ClientsTableComponent.html#editClient">editClient</a></li><li data-type='method'><a href="ClientsTableComponent.html#getAll">getAll</a></li><li data-type='method'><a href="ClientsTableComponent.html#renderClients">renderClients</a></li><li data-type='method'><a href="ClientsTableComponent.html#searchClient">searchClient</a></li><li data-type='method'><a href="ClientsTableComponent.html#setEvents">setEvents</a></li><li data-type='method'><a href="ClientsTableComponent.html#setRows">setRows</a></li></ul></li><li><a href="Database.html">Database</a><ul class='methods'><li data-type='method'><a href="Database.html#.closeConnection">closeConnection</a></li><li data-type='method'><a href="Database.html#.connect">connect</a></li><li data-type='method'><a href="Database.html#.sqlParse">sqlParse</a></li><li data-type='method'><a href="Database.html#consult">consult</a></li><li data-type='method'><a href="Database.html#delete">delete</a></li><li data-type='method'><a href="Database.html#find">find</a></li><li data-type='method'><a href="Database.html#getTotalRecords">getTotalRecords</a></li><li data-type='method'><a href="Database.html#insert">insert</a></li><li data-type='method'><a href="Database.html#update">update</a></li></ul></li><li><a href="HomeComponent.html">HomeComponent</a><ul class='methods'><li data-type='method'><a href="HomeComponent.html#initCards">initCards</a></li><li data-type='method'><a href="HomeComponent.html#logOut">logOut</a></li><li data-type='method'><a href="HomeComponent.html#openEstadistics">openEstadistics</a></li><li data-type='method'><a href="HomeComponent.html#openOrders">openOrders</a></li><li data-type='method'><a href="HomeComponent.html#openProducts">openProducts</a></li><li data-type='method'><a href="HomeComponent.html#openUsers">openUsers</a></li><li data-type='method'><a href="HomeComponent.html#reduceValues">reduceValues</a></li><li data-type='method'><a href="HomeComponent.html#showOptions">showOptions</a></li></ul></li><li><a href="LoadingComponent.html">LoadingComponent</a><ul class='methods'><li data-type='method'><a href="LoadingComponent.html#attributeChangedCallback">attributeChangedCallback</a></li><li data-type='method'><a href="LoadingComponent.html#connectedCallback">connectedCallback</a></li><li data-type='method'><a href="LoadingComponent.html#render">render</a></li></ul></li><li><a href="LoginPage.html">LoginPage</a><ul class='methods'><li data-type='method'><a href="LoginPage.html#handleSubmit">handleSubmit</a></li><li data-type='method'><a href="LoginPage.html#login">login</a></li><li data-type='method'><a href="LoginPage.html#renderErrors">renderErrors</a></li><li data-type='method'><a href="LoginPage.html#resetLoginForm">resetLoginForm</a></li><li data-type='method'><a href="LoginPage.html#validateForm">validateForm</a></li></ul></li><li><a href="ModalClientComponent.html">ModalClientComponent</a><ul class='methods'><li data-type='method'><a href="ModalClientComponent.html#checkClient">checkClient</a></li><li data-type='method'><a href="ModalClientComponent.html#closeModalClients">closeModalClients</a></li><li data-type='method'><a href="ModalClientComponent.html#handleChange">handleChange</a></li><li data-type='method'><a href="ModalClientComponent.html#openModalClients">openModalClients</a></li><li data-type='method'><a href="ModalClientComponent.html#renderClients">renderClients</a></li><li data-type='method'><a href="ModalClientComponent.html#searchClient">searchClient</a></li><li data-type='method'><a href="ModalClientComponent.html#setEvents">setEvents</a></li></ul></li><li><a href="ModalProductsComponent.html">ModalProductsComponent</a><ul class='methods'><li data-type='method'><a href="ModalProductsComponent.html#checkProduct">checkProduct</a></li><li data-type='method'><a href="ModalProductsComponent.html#closeModalProducts">closeModalProducts</a></li><li data-type='method'><a href="ModalProductsComponent.html#handleChange">handleChange</a></li><li data-type='method'><a href="ModalProductsComponent.html#openModalProducts">openModalProducts</a></li><li data-type='method'><a href="ModalProductsComponent.html#renderProducts">renderProducts</a></li><li data-type='method'><a href="ModalProductsComponent.html#searchProduct">searchProduct</a></li><li data-type='method'><a href="ModalProductsComponent.html#setEvents">setEvents</a></li></ul></li><li><a href="NotasController.html">NotasController</a><ul class='methods'><li data-type='method'><a href="NotasController.html#.actualizarNota">actualizarNota</a></li><li data-type='method'><a href="NotasController.html#.buscarNota">buscarNota</a></li><li data-type='method'><a href="NotasController.html#.calcularTotalNotas">calcularTotalNotas</a></li><li data-type='method'><a href="NotasController.html#.crearNota">crearNota</a></li><li data-type='method'><a href="NotasController.html#.exportarNotas">exportarNotas</a></li><li data-type='method'><a href="NotasController.html#.generarPDFNota">generarPDFNota</a></li><li data-type='method'><a href="NotasController.html#.importarNotas">importarNotas</a></li><li data-type='method'><a href="NotasController.html#.listarNotas">listarNotas</a></li><li data-type='method'><a href="NotasController.html#.mostrarAlerta">mostrarAlerta</a></li><li data-type='method'><a href="NotasController.html#.obtenerNota">obtenerNota</a></li><li data-type='method'><a href="NotasController.html#.obtenerNotasArray">obtenerNotasArray</a></li><li data-type='method'><a href="NotasController.html#.obtenerTotalNotas">obtenerTotalNotas</a></li><li data-type='method'><a href="NotasController.html#.obtenerUltimaNota">obtenerUltimaNota</a></li></ul></li><li><a href="NotasProductosController.html">NotasProductosController</a><ul class='methods'><li data-type='method'><a href="NotasProductosController.html#.actualizarNotasProductos">actualizarNotasProductos</a></li><li data-type='method'><a href="NotasProductosController.html#.insertarNotasProductos">insertarNotasProductos</a></li><li data-type='method'><a href="NotasProductosController.html#.restarCantidad">restarCantidad</a></li><li data-type='method'><a href="NotasProductosController.html#.retirarProductoNota">retirarProductoNota</a></li><li data-type='method'><a href="NotasProductosController.html#.sumarCantidad">sumarCantidad</a></li></ul></li><li><a href="OrdersForm.html">OrdersForm</a><ul class='methods'><li data-type='method'><a href="OrdersForm.html#calculateTotal">calculateTotal</a></li><li data-type='method'><a href="OrdersForm.html#confirmDeleteClient">confirmDeleteClient</a></li><li data-type='method'><a href="OrdersForm.html#confirmDeleteProduct">confirmDeleteProduct</a></li><li data-type='method'><a href="OrdersForm.html#deleteClient">deleteClient</a></li><li data-type='method'><a href="OrdersForm.html#deleteProduct">deleteProduct</a></li><li data-type='method'><a href="OrdersForm.html#getDeliveryNote">getDeliveryNote</a></li><li data-type='method'><a href="OrdersForm.html#getParamsUrl">getParamsUrl</a></li><li data-type='method'><a href="OrdersForm.html#handleChangeQuantity">handleChangeQuantity</a></li><li data-type='method'><a href="OrdersForm.html#handleSubmit">handleSubmit</a></li><li data-type='method'><a href="OrdersForm.html#resetForm">resetForm</a></li><li data-type='method'><a href="OrdersForm.html#selectClients">selectClients</a></li><li data-type='method'><a href="OrdersForm.html#selectProducts">selectProducts</a></li><li data-type='method'><a href="OrdersForm.html#sendData">sendData</a></li><li data-type='method'><a href="OrdersForm.html#setClientsTable">setClientsTable</a></li><li data-type='method'><a href="OrdersForm.html#setForm">setForm</a></li><li data-type='method'><a href="OrdersForm.html#setHtml">setHtml</a></li><li data-type='method'><a href="OrdersForm.html#setProductsTable">setProductsTable</a></li><li data-type='method'><a href="OrdersForm.html#validateForm">validateForm</a></li></ul></li><li><a href="OrdersTableComponent.html">OrdersTableComponent</a><ul class='methods'><li data-type='method'><a href="OrdersTableComponent.html#createDeliveryNote">createDeliveryNote</a></li><li data-type='method'><a href="OrdersTableComponent.html#editDeiliveryNote">editDeiliveryNote</a></li><li data-type='method'><a href="OrdersTableComponent.html#getAll">getAll</a></li><li data-type='method'><a href="OrdersTableComponent.html#getName">getName</a></li><li data-type='method'><a href="OrdersTableComponent.html#render">render</a></li><li data-type='method'><a href="OrdersTableComponent.html#searchDeliveryNote">searchDeliveryNote</a></li><li data-type='method'><a href="OrdersTableComponent.html#setEvents">setEvents</a></li><li data-type='method'><a href="OrdersTableComponent.html#setRows">setRows</a></li><li data-type='method'><a href="OrdersTableComponent.html#showPDF">showPDF</a></li></ul></li><li><a href="PaginationComponentElement.html">PaginationComponentElement</a><ul class='methods'><li data-type='method'><a href="PaginationComponentElement.html#attributeChangedCallback">attributeChangedCallback</a></li><li data-type='method'><a href="PaginationComponentElement.html#next">next</a></li><li data-type='method'><a href="PaginationComponentElement.html#prev">prev</a></li><li data-type='method'><a href="PaginationComponentElement.html#render">render</a></li><li data-type='method'><a href="PaginationComponentElement.html#sendPagination">sendPagination</a></li></ul></li><li><a href="PdfController.html">PdfController</a><ul class='methods'><li data-type='method'><a href="PdfController.html#crearReporte">crearReporte</a></li><li data-type='method'><a href="PdfController.html#createPdf">createPdf</a></li></ul></li><li><a href="ProductosController.html">ProductosController</a><ul class='methods'><li data-type='method'><a href="ProductosController.html#.activarProducto">activarProducto</a></li><li data-type='method'><a href="ProductosController.html#.buscarProducto">buscarProducto</a></li><li data-type='method'><a href="ProductosController.html#.crearProducto">crearProducto</a></li><li data-type='method'><a href="ProductosController.html#.editarCantidadProducto">editarCantidadProducto</a></li><li data-type='method'><a href="ProductosController.html#.editarProducto">editarProducto</a></li><li data-type='method'><a href="ProductosController.html#.exportarProductos">exportarProductos</a></li><li data-type='method'><a href="ProductosController.html#.importarProductos">importarProductos</a></li><li data-type='method'><a href="ProductosController.html#.insertarArrayProductos">insertarArrayProductos</a></li><li data-type='method'><a href="ProductosController.html#.listarCategorias">listarCategorias</a></li><li data-type='method'><a href="ProductosController.html#.listarProductos">listarProductos</a></li><li data-type='method'><a href="ProductosController.html#.listarProductosActivos">listarProductosActivos</a></li><li data-type='method'><a href="ProductosController.html#.obtenerProducto">obtenerProducto</a></li><li data-type='method'><a href="ProductosController.html#.obtenerTotalProductos">obtenerTotalProductos</a></li><li data-type='method'><a href="ProductosController.html#.obtenerTotalProductosActivos">obtenerTotalProductosActivos</a></li><li data-type='method'><a href="ProductosController.html#.obtenerTotalProductosExportar">obtenerTotalProductosExportar</a></li></ul></li><li><a href="ProductsTableComponent.html">ProductsTableComponent</a><ul class='methods'><li data-type='method'><a href="ProductsTableComponent.html#activeProduct">activeProduct</a></li><li data-type='method'><a href="ProductsTableComponent.html#createProduct">createProduct</a></li><li data-type='method'><a href="ProductsTableComponent.html#editProduct">editProduct</a></li><li data-type='method'><a href="ProductsTableComponent.html#getAll">getAll</a></li><li data-type='method'><a href="ProductsTableComponent.html#openModalConfirm">openModalConfirm</a></li><li data-type='method'><a href="ProductsTableComponent.html#render">render</a></li><li data-type='method'><a href="ProductsTableComponent.html#searchProducts">searchProducts</a></li><li data-type='method'><a href="ProductsTableComponent.html#selectProduct">selectProduct</a></li><li data-type='method'><a href="ProductsTableComponent.html#setName">setName</a></li><li data-type='method'><a href="ProductsTableComponent.html#setRows">setRows</a></li></ul></li><li><a href="ProfileModalComponent.html">ProfileModalComponent</a><ul class='methods'><li data-type='method'><a href="ProfileModalComponent.html#handleSubmit">handleSubmit</a></li><li data-type='method'><a href="ProfileModalComponent.html#openModalProfile">openModalProfile</a></li><li data-type='method'><a href="ProfileModalComponent.html#resetForm">resetForm</a></li><li data-type='method'><a href="ProfileModalComponent.html#setForm">setForm</a></li><li data-type='method'><a href="ProfileModalComponent.html#setHtml">setHtml</a></li><li data-type='method'><a href="ProfileModalComponent.html#validate">validate</a></li></ul></li><li><a href="ReporteController.html">ReporteController</a><ul class='methods'><li data-type='method'><a href="ReporteController.html#.buscarCantidadMaximaVendida">buscarCantidadMaximaVendida</a></li><li data-type='method'><a href="ReporteController.html#.buscarCantidadProductosVendidosAnual">buscarCantidadProductosVendidosAnual</a></li><li data-type='method'><a href="ReporteController.html#.buscarNotasCategoria">buscarNotasCategoria</a></li><li data-type='method'><a href="ReporteController.html#.buscarNotasVendidasPorVendedor">buscarNotasVendidasPorVendedor</a></li><li data-type='method'><a href="ReporteController.html#.buscarTotalProductosPorCategoria">buscarTotalProductosPorCategoria</a></li><li data-type='method'><a href="ReporteController.html#.generarReporte">generarReporte</a></li><li data-type='method'><a href="ReporteController.html#.getImageBuffer">getImageBuffer</a></li><li data-type='method'><a href="ReporteController.html#.ordenarMeses">ordenarMeses</a></li></ul></li><li><a href="ReportPDF.html">ReportPDF</a><ul class='methods'><li data-type='method'><a href="ReportPDF.html#createBarChart">createBarChart</a></li><li data-type='method'><a href="ReportPDF.html#createLineChart">createLineChart</a></li><li data-type='method'><a href="ReportPDF.html#createPieChart">createPieChart</a></li><li data-type='method'><a href="ReportPDF.html#createRandomColor">createRandomColor</a></li><li data-type='method'><a href="ReportPDF.html#transformBase64toArrayBuffer">transformBase64toArrayBuffer</a></li></ul></li><li><a href="ReportsComponent.html">ReportsComponent</a><ul class='methods'><li data-type='method'><a href="ReportsComponent.html#clearFilter">clearFilter</a></li><li data-type='method'><a href="ReportsComponent.html#createBarChart">createBarChart</a></li><li data-type='method'><a href="ReportsComponent.html#createLineChart">createLineChart</a></li><li data-type='method'><a href="ReportsComponent.html#createPieChart">createPieChart</a></li><li data-type='method'><a href="ReportsComponent.html#createRandomColor">createRandomColor</a></li><li data-type='method'><a href="ReportsComponent.html#deleteCharts">deleteCharts</a></li><li data-type='method'><a href="ReportsComponent.html#generateReport">generateReport</a></li><li data-type='method'><a href="ReportsComponent.html#generateStadistics">generateStadistics</a></li><li data-type='method'><a href="ReportsComponent.html#handleChangeBusiness">handleChangeBusiness</a></li><li data-type='method'><a href="ReportsComponent.html#handleChangeQuestions">handleChangeQuestions</a></li><li data-type='method'><a href="ReportsComponent.html#resetForm">resetForm</a></li><li data-type='method'><a href="ReportsComponent.html#setEvents">setEvents</a></li><li data-type='method'><a href="ReportsComponent.html#showPeriod">showPeriod</a></li><li data-type='method'><a href="ReportsComponent.html#validate">validate</a></li></ul></li><li><a href="SearchBarComponent.html">SearchBarComponent</a><ul class='methods'><li data-type='method'><a href="SearchBarComponent.html#connectedCallback">connectedCallback</a></li><li data-type='method'><a href="SearchBarComponent.html#disconnectedCallback">disconnectedCallback</a></li><li data-type='method'><a href="SearchBarComponent.html#getHtml">getHtml</a></li><li data-type='method'><a href="SearchBarComponent.html#handleChangeInput">handleChangeInput</a></li></ul></li><li><a href="UsersComponent.html">UsersComponent</a><ul class='methods'><li data-type='method'><a href="UsersComponent.html#changeView">changeView</a></li><li data-type='method'><a href="UsersComponent.html#setHtml">setHtml</a></li><li data-type='method'><a href="UsersComponent.html#setOptionsTabs">setOptionsTabs</a></li></ul></li><li><a href="UsersController.html">UsersController</a><ul class='methods'><li data-type='method'><a href="UsersController.html#.actualizarPerfil">actualizarPerfil</a></li><li data-type='method'><a href="UsersController.html#.buscarUsuarios">buscarUsuarios</a></li><li data-type='method'><a href="UsersController.html#.cambiarEstadoUsuarios">cambiarEstadoUsuarios</a></li><li data-type='method'><a href="UsersController.html#.cambiarRolUsuarios">cambiarRolUsuarios</a></li><li data-type='method'><a href="UsersController.html#.crearUsuario">crearUsuario</a></li><li data-type='method'><a href="UsersController.html#.listarUsuarios">listarUsuarios</a></li><li data-type='method'><a href="UsersController.html#.login">login</a></li><li data-type='method'><a href="UsersController.html#.obtenerTotalUsuarios">obtenerTotalUsuarios</a></li></ul></li><li><a href="UsersTableComponent.html">UsersTableComponent</a><ul class='methods'><li data-type='method'><a href="UsersTableComponent.html#changeRole">changeRole</a></li><li data-type='method'><a href="UsersTableComponent.html#deleteUser">deleteUser</a></li><li data-type='method'><a href="UsersTableComponent.html#getAll">getAll</a></li><li data-type='method'><a href="UsersTableComponent.html#getRowTable">getRowTable</a></li><li data-type='method'><a href="UsersTableComponent.html#newUser">newUser</a></li><li data-type='method'><a href="UsersTableComponent.html#openModalConfirm">openModalConfirm</a></li><li data-type='method'><a href="UsersTableComponent.html#renderUsers">renderUsers</a></li><li data-type='method'><a href="UsersTableComponent.html#searchUser">searchUser</a></li><li data-type='method'><a href="UsersTableComponent.html#setEvents">setEvents</a></li></ul></li></ul><h3>Modules</h3><ul><li><a href="module-excel.html">excel</a><ul class='methods'><li data-type='method'><a href="module-excel.html#~exportJSON">exportJSON</a></li><li data-type='method'><a href="module-excel.html#~generarLibroNotasExcel">generarLibroNotasExcel</a></li><li data-type='method'><a href="module-excel.html#~readFileExcelNotes">readFileExcelNotes</a></li><li data-type='method'><a href="module-excel.html#~readFileExcelProducts">readFileExcelProducts</a></li><li data-type='method'><a href="module-excel.html#~writeFileExcel">writeFileExcel</a></li></ul></li><li><a href="module-file.html">file</a><ul class='methods'><li data-type='method'><a href="module-file.html#~appendFile">appendFile</a></li><li data-type='method'><a href="module-file.html#~checkAsset">checkAsset</a></li><li data-type='method'><a href="module-file.html#~copyFile">copyFile</a></li><li data-type='method'><a href="module-file.html#~deleteFileSync">deleteFileSync</a></li><li data-type='method'><a href="module-file.html#~formatUrl">formatUrl</a></li><li data-type='method'><a href="module-file.html#~getHomePath">getHomePath</a></li><li data-type='method'><a href="module-file.html#~readFile">readFile</a></li><li data-type='method'><a href="module-file.html#~readFileAssets">readFileAssets</a></li><li data-type='method'><a href="module-file.html#~readFileImageAsync">readFileImageAsync</a></li><li data-type='method'><a href="module-file.html#~readFilePromiseJSON">readFilePromiseJSON</a></li><li data-type='method'><a href="module-file.html#~writeFile">writeFile</a></li></ul></li><li><a href="module-ModalCategoryFormComponent.html">ModalCategoryFormComponent</a><ul class='methods'><li data-type='method'><a href="module-ModalCategoryFormComponent.html#~cleanFormOnClose">cleanFormOnClose</a></li><li data-type='method'><a href="module-ModalCategoryFormComponent.html#~handleSubmit">handleSubmit</a></li><li data-type='method'><a href="module-ModalCategoryFormComponent.html#~openModalEditCategory">openModalEditCategory</a></li><li data-type='method'><a href="module-ModalCategoryFormComponent.html#~openModalNewCategory">openModalNewCategory</a></li><li data-type='method'><a href="module-ModalCategoryFormComponent.html#~resetForm">resetForm</a></li><li data-type='method'><a href="module-ModalCategoryFormComponent.html#~setForm">setForm</a></li><li data-type='method'><a href="module-ModalCategoryFormComponent.html#~validateData">validateData</a></li></ul></li><li><a href="module-ModalClientFormComponent.html">ModalClientFormComponent</a><ul class='methods'><li data-type='method'><a href="module-ModalClientFormComponent.html#~closeModal">closeModal</a></li><li data-type='method'><a href="module-ModalClientFormComponent.html#~handleSubmit">handleSubmit</a></li><li data-type='method'><a href="module-ModalClientFormComponent.html#~openModal">openModal</a></li><li data-type='method'><a href="module-ModalClientFormComponent.html#~resetFields">resetFields</a></li><li data-type='method'><a href="module-ModalClientFormComponent.html#~setForm">setForm</a></li><li data-type='method'><a href="module-ModalClientFormComponent.html#~validate">validate</a></li></ul></li><li><a href="module-ModalConfirmComponent.html">ModalConfirmComponent</a><ul class='methods'><li data-type='method'><a href="module-ModalConfirmComponent.html#~closeModalConfirm">closeModalConfirm</a></li><li data-type='method'><a href="module-ModalConfirmComponent.html#~openModalConfirm">openModalConfirm</a></li></ul></li><li><a href="module-ModalProductsForm.html">ModalProductsForm</a><ul class='methods'><li data-type='method'><a href="module-ModalProductsForm.html#~handleChangeQuantity">handleChangeQuantity</a></li><li data-type='method'><a href="module-ModalProductsForm.html#~handleSubmit">handleSubmit</a></li><li data-type='method'><a href="module-ModalProductsForm.html#~openModalEditProduct">openModalEditProduct</a></li><li data-type='method'><a href="module-ModalProductsForm.html#~openModalNewProduct">openModalNewProduct</a></li><li data-type='method'><a href="module-ModalProductsForm.html#~resetFormProducts">resetFormProducts</a></li><li data-type='method'><a href="module-ModalProductsForm.html#~setForm">setForm</a></li><li data-type='method'><a href="module-ModalProductsForm.html#~validateData">validateData</a></li></ul></li><li><a href="module-ModalUserFormComponent.html">ModalUserFormComponent</a><ul class='methods'><li data-type='method'><a href="module-ModalUserFormComponent.html#~closeModal">closeModal</a></li><li data-type='method'><a href="module-ModalUserFormComponent.html#~getForm">getForm</a></li><li data-type='method'><a href="module-ModalUserFormComponent.html#~openModal">openModal</a></li><li data-type='method'><a href="module-ModalUserFormComponent.html#~resetFields">resetFields</a></li><li data-type='method'><a href="module-ModalUserFormComponent.html#~setForm">setForm</a></li><li data-type='method'><a href="module-ModalUserFormComponent.html#~validateForm">validateForm</a></li></ul></li><li><a href="module-NoteModel.html">NoteModel</a><ul class='methods'><li data-type='method'><a href="module-NoteModel.html#~validate">validate</a></li></ul></li><li><a href="module-ProductModel.html">ProductModel</a><ul class='methods'><li data-type='method'><a href="module-ProductModel.html#~validate">validate</a></li></ul></li><li><a href="module-string.html">string</a><ul class='methods'><li data-type='method'><a href="module-string.html#~sliceString">sliceString</a></li></ul></li><li><a href="module-time.html">time</a><ul class='methods'><li data-type='method'><a href="module-time.html#~dateSpanish">dateSpanish</a></li><li data-type='method'><a href="module-time.html#~dateToString">dateToString</a></li><li data-type='method'><a href="module-time.html#~showLog">showLog</a></li></ul></li><li><a href="module-transformers.html">transformers</a><ul class='methods'><li data-type='method'><a href="module-transformers.html#~transformarData">transformarData</a></li></ul></li><li><a href="module-UsersModalRole.html">UsersModalRole</a><ul class='methods'><li data-type='method'><a href="module-UsersModalRole.html#~closeModalRole">closeModalRole</a></li><li data-type='method'><a href="module-UsersModalRole.html#~getForm">getForm</a></li><li data-type='method'><a href="module-UsersModalRole.html#~openModalRole">openModalRole</a></li><li data-type='method'><a href="module-UsersModalRole.html#~setForm">setForm</a></li></ul></li></ul><h3>Global</h3><ul><li><a href="global.html#categoryTableComponent">categoryTableComponent</a></li><li><a href="global.html#clientsTableComponent">clientsTableComponent</a></li><li><a href="global.html#createWindow">createWindow</a></li><li><a href="global.html#CRUD">CRUD</a></li><li><a href="global.html#getPaginationStorage">getPaginationStorage</a></li><li><a href="global.html#getUserLogged">getUserLogged</a></li><li><a href="global.html#hideElement">hideElement</a></li><li><a href="global.html#homeComponent">homeComponent</a></li><li><a href="global.html#initMainMenu">initMainMenu</a></li><li><a href="global.html#modalClientComponent">modalClientComponent</a></li><li><a href="global.html#modalProductsComponent">modalProductsComponent</a></li><li><a href="global.html#mysqlAPI">mysqlAPI</a></li><li><a href="global.html#ordersForm">ordersForm</a></li><li><a href="global.html#ordersTableComponent">ordersTableComponent</a></li><li><a href="global.html#productsComponent">productsComponent</a></li><li><a href="global.html#productsTableComponent">productsTableComponent</a></li><li><a href="global.html#profileModalComponent">profileModalComponent</a></li><li><a href="global.html#redirectTo">redirectTo</a></li><li><a href="global.html#renderErrors">renderErrors</a></li><li><a href="global.html#reportsComponent">reportsComponent</a></li><li><a href="global.html#setPaginationStorage">setPaginationStorage</a></li><li><a href="global.html#setUserLogged">setUserLogged</a></li><li><a href="global.html#showElement">showElement</a></li><li><a href="global.html#usersComponent">usersComponent</a></li><li><a href="global.html#usersTableComponent">usersTableComponent</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">controllers/productos-controllers.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Product
 * @typedef {Object} Product
 * @property {number} [productoid] identificador de producto
 * @property {number} userid identificador de usuario
 * @property {number} categoriaid identificador de categoria
 * @property {string} nombre nombre del producto
 * @property {string} descripcion descripcion de producto
 * @property {number} precio precio del producto
 * @property {number} cantidad cantidad de productos
 * @property {boolean} disponibilidad disponibilidad de producto
 */

const { Notification, dialog, BrowserWindow } = require('electron');

const { Database } = require('../database/database'); 
const ProductModel = require('../models/product');
const CRUD = require('../database/CRUD');

const excelModule = require('../util-functions/excel');
const fileModule = require('../util-functions/file');


/** clase que gestiona los productos */
class ProductosController {

	/** @type {?Database} */
	databaseInstance = null;

	/** Propiedad get database retorna una nueva instancia de la clase Database */
	static get database() {
		return this.databaseInstance || ( this.databaseInstance = new Database() );
	}

	/**
	 * Exporta los productos en un archivo de excel
	 * @returns {Promise&lt;string>}
	 */
	static exportarProductos() {

		return new Promise(( resolve, reject ) => {

			// almacena una instancia de notificacion al usuario
			const notificacion = new Notification();
			const extensiones = ['.json', '.xls', '.xlsx']
			
			/** @type {Electron.SaveDialogOptions} */
			const opciones = { 
				title: 'Exportar Archivo', 
				filters: [ 
					{ name: 'Archivo excel', extensions: ['xls', 'xlsx'] },
					{ name: 'Archivo json', extensions: ['json'] },
				], 
			};
	
			let path = '';
			
			//  asi se consume
			dialog.showSaveDialog( BrowserWindow.getFocusedWindow(), opciones )
				.then( respuesta => {
					
					let message = 'Cancelada';

					if ( respuesta.canceled ) {
					
						// abortamos la ejecucion del resto de promesas
						// pasamos al catch
						throw message;
					}
	
					// validamos que el archivo cumpla con una de las 
					// extensiones
					let validacion = extensiones.some(( extension ) => { 
						return respuesta.filePath.includes( extension ); 
					});
	
					// console.log({ respuesta, validacion });			
	
					if ( validacion === false ) {
						message = 'La extensión del archivo no es valida';

						notificacion.title = 'Atención';
						notificacion.body = message;
	
						notificacion.show();
						
						// abortamos la ejecucion del resto de promesas
						// pasamos al catch
						throw message;
					}
	
					// asignamos el path al scope superior
					path = respuesta.filePath;
	
					return ProductosController.obtenerTotalProductosExportar();
				})
				.then( consultaDB => {
					
					// aqui obtienes la respuesta de la BD de datos
					// console.log({ path }); 
	
					// validamos si es un JSON
					if ( path.includes( extensiones[0] ) ) {
						return excelModule.exportJSON( path, consultaDB );
					}
					
					// aqui obtienes las respuesta de la promesa path y 
					// arreglo de objetos de la data del sql
					return excelModule.writeFileExcel( path, consultaDB, 'ordenes' );
				})
				.then( respuestaArchivo => {
	
					console.log( respuestaArchivo );
					
					notificacion.body = respuestaArchivo;
					notificacion.title = 'Exito';
					
					notificacion.show();

					resolve( respuestaArchivo );
				})
				.catch( error => {
					console.log( error );

					reject( error );
				});
		});
	}

	/**
	 * Importa los productos en un archivo excel
	 * @returns {Promise&lt;void>}
	 */
	static importarProductos() {

		let message = 'Cancelada';

		/** funcion que muestra el alert de campos incorrectos */
		const mostrarMensaje = () => {

			message = 'El orden de los campos importados son incorrectos';
				
			dialog.showErrorBox(
				'Error',
				(
					'Los campos en el archivo son incorrectos.\n\n' +
					'Consulta el manual para obtener más información\n' +
					'sobre como importar archivos.'
				)
			);
					
			throw message; 
		};

		return new Promise(( resolve, reject ) => {
			
			const notificacion = new Notification();
			const extensiones = ['.json', '.xls', '.xlsx'];
			
			/** @type {Electron.OpenDialogOptions} */
			const opciones = { 
					title: 'Importar Archivo', 
					filters: [ 
						{ name: 'Archivo excel', extensions: ['xls', 'xlsx'] },
						{ name: 'Archivo json', extensions: ['json'] },
					], 
			};
	
			let path = '';
	
			dialog.showOpenDialog( BrowserWindow.getFocusedWindow(), opciones )
				.then( respuestaVentana => {
	
					if ( respuestaVentana.canceled ) {
						
						// abortamos la ejecucion del resto de promesas
						// pasamos al catch
						throw message;
					}	
	
					path = respuestaVentana.filePaths[0];
					
					const validacion = extensiones.some( extension => path.includes( extension ) );
	
					if ( !validacion ) {
						message = 'La extension del archivo no es valida';
	
						notificacion.title = 'Atención';
						notificacion.body = message;
	
						notificacion.show();
						
						// abortamos la ejecucion del resto de promesas
						// pasamos al catch
						throw message;
					}	
	
					// validamos si es un JSON
					if ( path.includes( extensiones[0] ) ) {
						return fileModule.readFilePromiseJSON( path, true );
					}

					return excelModule.readFileExcelProducts( path );	
					
				})
				.then( productos => {

					const validacion = productos.every( product => ProductModel.validate( product ) );
					
					// console.log( validate );  

					if ( !validacion ) {
						mostrarMensaje();
					}
							
					return ProductosController.insertarArrayProductos( 
						CRUD.importarProductos, 
						productos 
					);
				})
				.then( respuesta => {
					
					// console.log( respuesta );

					const notificacion = new Notification({
						title: 'Éxito',
						body: 'Productos importados con éxito'
					});

					notificacion.show();
					
					resolve( respuesta );
				})			
				.catch( error => {
					
					console.log( error );
					
					reject( error );
				});
		});
	}

	/**
	 * Inserta un array de productos en la BD
	 * @param {string} sql consulta SQL
	 * @param {Array&lt;Product>} productos array de productos
	 * @returns {Promise&lt;string>}
	 */
	static insertarArrayProductos( sql, productos ) {
	
		return new Promise(( resolve, reject ) => {
			
			// 1. transformar los valores a string dentro de un arreglo usando map
			let dataProductos = productos.map(( producto ) => {

				if ( !this.database._mysqlAPI ) {
					return '';
				}

				// este es el values SQL que se va a concatenar
				return ("(" +
					this.database._mysqlAPI.escape( producto.userid ) + ", " +
					this.database._mysqlAPI.escape( producto.categoriaid ) + ", " + 
					this.database._mysqlAPI.escape( producto.nombre )  + ", " + 
					this.database._mysqlAPI.escape( producto.descripcion )  + ", " + 
					this.database._mysqlAPI.escape( producto.cantidad )  + ", " + 
					this.database._mysqlAPI.escape( producto.precio )  + ", " + 
					this.database._mysqlAPI.escape( producto.disponibilidad ) +	
				")");
			});

			// 2. Se transforma el array en string
			dataProductos = dataProductos.join(',');

			/**
			 * Se decide reemplazar values pasar directamente la cadena sql porque el segundo 
			 * parametro escapa el valor del string y manda los valores entre comillados
			 *
			 * 3. se sustituye manualmente el valor con String.replace
 			*/
			sql = sql.replace(':values', dataProductos );

			// 4. se manda a la BD con el parametro data en null
			this.database.insert( sql, null, ( error ) => {

				if ( error ) {

					reject( error );

					return;
				}
				
				resolve('Productos importados con éxito');
			});
		});

	}

	/**
	 * Añade un nuevo producto
	 *
	 * @param  {Product} producto instancia del producto
	 * @param  {User} usuario usuario logeado
	 */
	static crearProducto( producto, usuario ) {

		let nuevoProducto = {
			...producto,
			userid: usuario['userid']
		};

		// console.log( nuevoProducto );

		this.database.insert( CRUD.crearProducto, nuevoProducto, ( error ) => {

			const notificacion = new Notification({
				title: '',
				body: ''
			});

			if ( error ) {

				notificacion['title'] = 'Error!!';
				notificacion['body'] = 'Error al crear producto';

				notificacion.show();

				return;
			}

			notificacion['title'] = 'Éxito';
			notificacion['body'] = 'Producto creado con éxito';

			notificacion.show();

		});
	}

	/**
	* Obtiene el total de los productos
	* @returns {Promise&lt;{ totalPaginas: number, totalRegistros: number }>}
	*/
	static obtenerTotalProductos() {

		return new Promise( ( resolve, reject ) => {

			this.database.getTotalRecords( CRUD.obtenerTotalProductos, ( error, resultado ) => {

				const notificacion = new Notification({
					title: 'Error en obtener los registros',
					body: 'No se pudo obtener el total de registros'
				});

				if ( error ) {

					notificacion.show();

					console.log( error );

					reject( error );

					return;
				}

				const totalRegistros = resultado[0]['COUNT(*)'];

				let totalPaginas = ( totalRegistros / 10 );

				resolve({
					totalPaginas: Math.ceil( totalPaginas ),
					totalRegistros: totalRegistros
				});

			});

		});
	}

	/**
	* Obtiene el total de los productos para exportar
	* @returns {Promise&lt;Array&lt;Product>>}
	*/
	static obtenerTotalProductosExportar() {
		
		return new Promise(( resolve, reject ) => {
			this.database.consult( CRUD.exportarProductos, ( error, resultados ) => {
					
				// lo capturamos en el catch
				if ( error ) {
					reject({
						error: 'Error en la consulta BD',
						detail: error
					});

					return
				}

				// console.log( resultados );

				// aqui no puedo retorna la promesa porque el then no se ejeucuta
				// porque este return es el callback
				resolve( resultados );
			});
		});
	}

	/**
	* Obtiene el total de los productos disponibles
	* @returns {Promise&lt;{ totalPaginas: number, totalRegistros: number }>}
	*/
	static obtenerTotalProductosActivos() {

		return new Promise(( resolve, reject ) => {
			this.database.getTotalRecords( CRUD.obtenerTotalProductosActivos, ( error, resultado ) => {

				const notificacion = new Notification({
					title: 'Error en obtener los registros',
					body: 'No se pudo obtener el total de registros'
				});

				if ( error ) {

					notificacion.show();

					console.log( error );

					reject( error );

					return;
				}

				const totalRegistros = resultado[0]['COUNT(*)'];

				let totalPaginas = ( totalRegistros / 10 );

				resolve({
					totalPaginas: Math.ceil( totalPaginas ),
					totalRegistros: totalRegistros
				});

			});
		});
	}


	/**
	 * Listar productos
	 *
	 * @param  {Array&lt;number>} pagination array de paginacion
	 * @return {Promise&lt;Array&lt;Product>>}  devuelve una promesa con los productos paginados
	 */
	static listarProductos( pagination ) {

		return new Promise(( resolve, reject ) => {

			pagination = { start: pagination[0], limit: pagination[1] };

			this.database.consult( CRUD.listarProductos, pagination, ( error, results ) => {

				if ( error ) {

					console.log( error );

					reject( error );

					return;
				}

				// console.log( results );
				resolve( results );
			});

		});
	}

	/**
	 * Listar productos activos
	 *
	 * @param  {Array&lt;number>} pagination array de paginacion
	 * @return {Promise&lt;Array&lt;Product>>}  devuelve una promesa con los productos disponibles paginados
	 */
	static listarProductosActivos( pagination ) {

		return new Promise(( resolve, reject ) => {

			pagination = { start: pagination[0], limit: pagination[1] };

			this.database.consult( CRUD.listarProductosActivos, pagination, ( error, results ) => {

				if ( error ) {

					console.log( error );

					reject( error );

					return;
				}

				// console.log( results );
				resolve( results );
			});

		});
	}


	/**
	 * Lista las categorias
	 * @return {Promise&lt;Array&lt;Category>>}  devuelve una promesa devolviendo el listado de categorias
	 */
	static listarCategorias() {

		return new Promise(( resolve, reject ) => {

			this.database.consult( CRUD.listadoCategoriasProductos, ( error, results ) => {

				if ( error ) {
					console.log( error );

					reject( error );
				}

				resolve( results );
			})
		})
	}

	/**
	 * edita un producto
	 *
	 * @param  {Product} producto instancia del producto
	 */
	static editarProducto( producto ) {

		// console.log (producto, "&lt;-- log del producto");

		this.database.update( CRUD.editarProducto, producto, ( error ) => {

			const notificacion = new Notification({
				title: '',
				body: ''
			});

			if ( error ) {

				// throw error;  // mostrará el error en pantalla

				notificacion['title'] = 'Error!!';
				notificacion['body'] = 'Error al actualizar producto';

				notificacion.show();

				console.log( error );

				return;
			}

				notificacion['title'] = 'Exito!!';
				notificacion['body'] = 'Producto Modificado';

				notificacion.show();
  		});
	}


	/**
	 * edita la cantidad del producto
	 *
	 * @param  {Object} productoActualizado objecto del producto actualizado
	 * @param {number} productoActualizado.productoid identificador del producto
	 * @param {number} productoActualizado.sumaAlgebraica resultado de la suma algebraica
	 * @param  {callback} callback  callback de respuesta al finalizar la actualizacion del producto
	 */
	static editarCantidadProducto( productoActualizado, callback = null ) {

		this.database.update( CRUD.actualizarCantidadProducto, productoActualizado, ( error ) => {

			const notificacion = new Notification({
				title: '',
				body: ''
			});

			if ( error ) {

				console.log( error );

				notificacion['title'] = 'Error !!';
				notificacion['body'] = 'Error al actualizar la nota';

				notificacion.show();

				// throw error;

				return;
			}

			if ( callback ) {
				callback();
			}

			// console.log('  producto actualizado  ');

  	});
	}


	/**
	 * activa o desactiva la disponibilidad del producto
	 *
	 * @param  {Object} producto
	 * @param {number} producto.productoid  identificador de producto
	 * @param {boolean} producto.disponibilidad disponibilidad de producto
	 */
	static activarProducto( producto ) {

		//console.log (producto, "&lt;-- log del producto");

		this.database.update( CRUD.activarProducto, producto, ( error ) => {

			const notificacion = new Notification({
				title: '',
				body: ''
			});

			if ( error ) {

				// throw error;  // mostrará el error en pantalla

				notificacion['title'] = 'Error!!';
				notificacion['body'] = 'Error al actualizar producto';

				notificacion.show();

				console.log( error );

				return;
			}

			notificacion['title'] = 'Exito!!';
			notificacion['body'] = 'Producto Modificado';

			notificacion.show();
  		});
	}


	/**
	 * Permite buscar clientes en la BD
	 * @param  {Object} search producto a buscar
	 * @param {string} search.search cadena de busqueda del producto
	 * @return {Promise&lt;Array&lt;Product>>}  devuelve una promesa con los resultados encontrados
	*/
	static buscarProducto( search ) {

		return new Promise(( resolve, reject ) => {

				this.database.find( CRUD.buscarProducto, search, ( error, results ) => {

					const notificacion = new Notification({
						title: '',
						body: ''
					});

					if ( error ) {

						// throw error;  // mostrará el error en pantalla

						notificacion['title'] = 'Error!!';
						notificacion['body'] = 'Error al buscar Producto';

						notificacion.show();

						console.log( error );

						reject( error );

						return;
					}

					resolve( results );
				});
		});
	}

	/**
	 * Obtiene una instancia de un producto
	 * @param {number} idProduct 
	 * @returns {Promise&lt;Product>}
	 */
	static obtenerProducto( idProduct ) {
		return new Promise(( resolve, reject ) => {
			
			this.database.consult(CRUD.obtenerProducto, { productoid: idProduct }, ( error,  results ) => {

				if ( error ) {
					console.log( error );
					reject( error );

					return;
				}

				// console.log( results );

				const [ result ] = results;

				resolve( result );
			});
		});
	}

}

module.exports = { ProductosController };
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.7</a> on Thu Mar 16 2023 08:33:25 GMT-0400 (hora de Venezuela) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>



</body>
</html>
